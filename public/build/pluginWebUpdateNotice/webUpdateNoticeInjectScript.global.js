"use strict";(()=>{var f="pluginWebUpdateNotice",N="web_version_by_plugin";var I="plugin_web_update_notice",T="plugin-web-update-notice-anchor",w="plugin-web-update-notice-refresh-btn",g="plugin-web-update-notice-dismiss-btn",b="web_update_check_dismiss_version_",E={topLeft:"top: 24px;left: 24px",topRight:"top: 24px;right: 24px",bottomLeft:"bottom: 24px;left: 24px",bottomRight:"bottom: 24px;right: 24px"};var D={zh_CN:{title:"\u53D1\u73B0\u65B0\u7248\u672C",description:"\u7F51\u9875\u66F4\u65B0\u5566\uFF01\u8BF7\u5237\u65B0\u9875\u9762\u540E\u4F7F\u7528\u3002",buttonText:"\u5237\u65B0",dismissButtonText:"\u5FFD\u7565"},zh_TW:{title:"\u767C\u73FE\u65B0\u7248\u672C",description:"\u7DB2\u9801\u66F4\u65B0\u5566\uFF01\u8ACB\u5237\u65B0\u9801\u9762\u5F8C\u4F7F\u7528\u3002",buttonText:"\u5237\u65B0",dismissButtonText:"\u5FFD\u7565"},en_US:{title:"Discover new version",description:"A new version is available! Please refresh the page.",buttonText:"Refresh",dismissButtonText:"Dismiss"}},d=D;var m=!1,u="",s="";function R(t,e){let i=!1;return function(...c){i||(i=!0,t.apply(this,c),setTimeout(()=>{i=!1},e))}}function U(t){let{injectFileBase:e="",checkInterval:i,hiddenDefaultNotification:c}=t,a=()=>{window.fetch(`${e}${f}/${N}.json?t=${performance.now()}`).then(o=>{if(!o.ok)throw new Error(`Failed to fetch ${N}.json`);return o.json()}).then(({version:o})=>{if(u=o,window.pluginWebUpdateNotice_version!==o){document.body.dispatchEvent(new CustomEvent(I,{detail:{options:t,version:o},bubbles:!0}));let n=localStorage.getItem(`${b}${o}`)==="true";!m&&!c&&!n&&B(t)}}).catch(o=>{console.error("[pluginWebUpdateNotice] Failed to check system update",o)})};setTimeout(a),setInterval(a,i||10*60*1e3);let r=R(a,5e3);window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&r()}),window.addEventListener("focus",()=>{r()}),window.addEventListener("error",o=>{o?.target?.tagName==="SCRIPT"&&a()},!0)}window.pluginWebUpdateNotice_={checkUpdate:U,dismissUpdate:S,closeNotification:h,setLocale:t=>{window.pluginWebUpdateNotice_.locale=t,s=t}};function h(){m=!1,document.querySelector(`.${T} .plugin-web-update-notice`)?.remove()}function S(){try{h(),localStorage.setItem(`${b}${u}`,"true")}catch(t){console.error(t)}}function $(){document.querySelector(`.${w}`)?.addEventListener("click",()=>{let{onClickRefresh:i}=window.pluginWebUpdateNotice_;if(i){i(u);return}window.location.reload()}),document.querySelector(`.${g}`)?.addEventListener("click",()=>{let{onClickDismiss:i}=window.pluginWebUpdateNotice_;if(i){i(u);return}S()})}function p(t,e,i){return i[t]?.[e]??d[t]?.[e]??d.zh_CN[e]}function B(t){try{m=!0;let{notificationProps:e,notificationConfig:i,customNotificationHTML:c,hiddenDismissButton:a,locale:r="zh_CN",localeData:o}=t,n=Object.assign({},d,o);s||(s=r,window.pluginWebUpdateNotice_.locale=r);let l=document.createElement("div"),_="";if(c)_=c;else{let{placement:A="bottomRight",primaryColor:C,secondaryColor:O}=i||{},L=e?.title??p(s,"title",n),x=e?.description??p(s,"description",n),y=e?.buttonText??p(s,"buttonText",n),v=e?.dismissButtonText??p(s,"dismissButtonText",n),M=a?"":`<a class="plugin-web-update-notice-btn plugin-web-update-notice-dismiss-btn" style="color:${O}">${v}</a>`;l.classList.add("plugin-web-update-notice"),l.style.cssText=`${E[A]}`,_=`
    <div class="plugin-web-update-notice-content" data-cy="notification-content">
      <div class="plugin-web-update-notice-content-title">
        ${L}
      </div>
      <div class="plugin-web-update-notice-content-desc">
        ${x}
      </div>
      <div class="plugin-web-update-notice-tools">
        ${M}
        <a class="plugin-web-update-notice-btn plugin-web-update-notice-refresh-btn" style="color:${C}">
          ${y}
        </a>
      </div>
    </div>`}l.innerHTML=_,document.querySelector(`.${T}`).appendChild(l),$()}catch(e){console.error("[pluginWebUpdateNotice] Failed to show notification",e)}}})();
//# sourceMappingURL=webUpdateNoticeInjectScript.global.js.map
        window.pluginWebUpdateNotice_.checkUpdate({"logVersion":true,"logHash":true,"checkInterval":30000,"notificationProps":{"title":"system update","description":"System update, please refresh the page","buttonText":"refresh"},"injectFileBase":"/build/"});